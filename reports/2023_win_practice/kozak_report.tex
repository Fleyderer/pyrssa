\documentclass[specialist,
			   substylefile = spbu_report.rtx,
			   subf,href,colorlinks=true, 12pt]{disser}

\usepackage[a4paper,
			mag=1000, includefoot,
			left=3cm, right=1.5cm, top=2cm, bottom=2cm, headsep=1cm, footskip=1cm]{geometry}
\usepackage[utf8]{inputenc}
\usepackage[backend = bibtex8,sorting=none]{biblatex}
\usepackage[T2A]{fontenc}
\usepackage[english,russian]{babel}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{listings}
\usepackage{graphicx}
\usepackage{tabularx}
\usepackage{float}
\usepackage{slashbox}
\usepackage{xcolor}
\input{letters_series_mathbb}
\input{newcommands}
\ifpdf\usepackage{epstopdf}\fi
% Точка с запятой в качестве разделителя между номерами цитирований
%\setcitestyle{semicolon}

% Добавить больший абзац после листинга
\lstset{
	belowskip=20pt,
	showstringspaces=false
}

% форматирование языка RsT
\lstdefinelanguage{RsT}
{
	directives={example, Example, EXAMPLE},
	delim=*[directive]{..\ },
	directivestyle=\color{red}\underbar,
}[
keywords,
directives,
comments,
]

\graphicspath{ {images/} }
\addbibresource{lit.bib}

% Использовать полужирное начертание для векторов
\let\vec=\mathbf

% Включать подсекции в оглавление
\setcounter{tocdepth}{2}

\makeatletter
\setlength{\@fptop}{0pt}
\makeatother

%----------------------------------------------------------------
\begin{document}

%
% Титульный лист на русском языке
%
% Название организации
\institution{%
	Санкт-Петербургский государственный университет\\
	Прикладная математика и информатика
}

\title{Отчет по производственной практике (педагогической) (семестр 3)}

% Тема
\topic{Написание файла помощи для SSA на Python}

% Автор
\author{Козак Михаил Валерьевич}
\group{группа 21.М03-мм}

% Научный руководитель
\sa       {Голяндина Нина Эдуардовна\\%
		   Кафедра Статистического Моделирования}
\sastatus {к.\,ф.-м.\,н., доцент}

% Город и год
\city{Санкт-Петербург}
\date{2022}

\maketitle

\tableofcontents

\chapter{Введение}

Singular spectrum analysis (SSA) \cite{ssa-method} – метод для анализа временных рядов, основанный на преобразовании одномерного временного ряда в многомерный, с последующим применением к нему метода главных компонент. Данный метод находит применение в различных сферах: климатология, океанология, геофизика, техника, обработка изображений, медицина, эконометрика и многие другие. \\

Данный метод активно применяется в обучении студентов, в связи с чем требуется своевременная адаптация инструментов, позволяющих применять его на практике. С этой целью для использования метода SSA в популярном языке программирования Python ведется разработка пакета pyrssa \cite{pyrssa-lib}, который является адаптацией существующей для языка R библиотеки Rssa \cite{rssa-book, rssa-doc}, использующей алгоритмы, реализованные на языке C с целью повышения скорости работы. 

Пакет Rssa  содержит исчерпывающую документацию, в которой есть как информация по самим функциям библиотеки и примерам их использования, так и ссылки на литературу с описанием алгоритмов, которые легли в основу пакета. Вся эта информация позволяет обучающимся достаточно быстро получать справку и о методах, и об инструментах для их применения. Необходимость переноса существующей документации вызвана в первую очередь тем, что адаптированная для Python версия пакета в силу отличий от языка R содержит изменения как в структуре модулей, так и в доступных и используемых типах данных. В силу отличий синтаксиса языков возникла необходимость произвести адаптацию примеров использования пакета  для документации, а также для удобства обучающихся: вся необходимая информация должна быть доступна пользователям сразу и в наглядном формате.

Таким образом, в рамках данной работы стояла задача создания и оформления файлов помощи для пакета pyrssa, основываясь на уже существующей документации для Rssa. 

Помимо непосредственно адаптации также стояла задача максимально упростить для пользователей взаимодействие с документацией – предоставить различные способы обращения к ней, а также создать удобную структуру и возможность навигации по файлам помощи. Наиболее универсальным способом на текущий момент являются веб-страницы, в связи с тем, что они адаптированы для различных устройств, будь то стационарные компьютеры или мобильные устройства, а также для различных операционных систем. В связи с этим главной задачей являлось написание документации в формате веб-сайта и его публикация в интернете для общего доступа.


\chapter{Документация для pyrssa}

Для оформления документации был выбран пакет sphinx \cite{sphinx-lib}, обладающий обширной функциональностью и, что самое главное, достаточно высоким уровнем автоматизации работы: определение структуры модуля, к которому пишется документация, создание удобных заготовок веб-страниц с навигацией, простое, но многофункциональное форматирование текста документации, связывание ссылок на определенные в модуле классы – лишь часть доступных возможностей. Во многом благодаря этому данный пакет стал стандартом для оформления документации библиотек, написанных на языке Python. Далее будут описаны предпринятые для создания файлов помощи действия.

\section{Создание заготовок для веб-страниц}

В первую очередь, после установки самого пакета, требуется выполнить набор простых команд в терминале для создания заготовки файла конфигурации, который содержит основную информацию о библиотеке, такую как название и автор, а также позволяет выбрать используемые расширения, позволяющие ускорить работу с документацией, указать директории, в которых будет производиться поиск при создании веб-страниц, и исключить те, которые не должны приниматься в рассмотрение. Ниже приведено примерное содержание данного файла за исключением комментариев, которые создаются для навигации в случае возникновения вопросов при оформлении.

\begin{lstlisting}[language=Python, caption=Содержимое конфигурационного файла.]
	
	from sphinx.ext import autodoc
	import os
	import sys
	sys.path.insert(0, os.path.abspath('..'))

	project = 'pyrssa'
	copyright = '2023, Fleyderer'
	author = 'Fleyderer'
	release = '1.0.6'
	
	extensions = [
	'sphinx.ext.autodoc',
	'sphinx.ext.viewcode',
	'sphinx.ext.napoleon'
	]
	
	templates_path = ['_templates']
	exclude_patterns = ['_build', 'Thumbs.db', '.DS_Store']
	
	html_theme = 'sphinx_rtd_theme'
	html_static_path = ['_static']
	add_module_names = False
	
	class MockedClassDocumenter(autodoc.ClassDocumenter):
	def add_line(self,
	             line: str, 
	             source: str, *lineno: int) -> None:
	if line == "   Bases: :py:class:`object`":
	return
	super().add_line(line, source, *lineno)
	
	autodoc.ClassDocumenter = MockedClassDocumenter
\end{lstlisting}

В указанном выше фрагменте кода импортируются необходимые модули, указывается основная директория для поиска при сборке HTML-файлов, а также информация о пакете, выбираются необходимые расширения, которые проводят автоматический парсинг написанной документации в соответствии с различными стилями форматирования текста. Помимо этого указываются исключаемые файлы, устанавливается визуальный стиль оформления веб-страниц, а также создается дополнительная обертка для того, чтобы исключать из генерируемых файлов ненужную информацию, которая не понадобится пользователю. Наполнение этой обертки остается на усмотрение пользователя.

После того, как данный файл успешно оформлен, необходимо сгенерировать файлы с расширением .rst – это расширение файлов типа reStructuredText \cite{rst-doc}, являющегося облегчённым языком разметки. С помощью таких файлов оформление навигации становится проще, чем при использовании стандартного HTML. Для этого терминал открывается в основной директории модуля и при выполнении команды для создания файлов выбирается дочерняя директория, внутри которой эти файлы должны находиться. После этого, если при выполнении предыдущих действий не были допущены ошибки, создаются файлы разметки. Во фрагменте кода, приведенном ниже, указано примерное содержание заглавной страницы документации, написанной с помощью reStructureText.

\begin{lstlisting}[language=RsT, caption=Содержимое файла заглавной страницы документации.]
	Welcome to pyrssa's documentation!
	==================================
	
	Methods and tools for Singular Spectrum Analysis
	in Python...

	
	.. toctree::
	:maxdepth: 2
	:caption: Contents:
	
	pyrssa
	
	
	Indices and tables
	==================
	
	* :ref:`genindex`
	* :ref:`modindex`
	* :ref:`search`
\end{lstlisting}
	
После внесения необходимых правок в относящиеся к модулю .rst-файлы, будь то изменения в структуре документации или же наполнении отдельных страниц, с помощью простой команды создаются файлы HTML, которые доступны для просмотра на различных устройствах. Примерный внешний вид заглавной веб-страницы приведен на иллюстрациях ниже.

\begin{figure}[H]
	\centering
	\includegraphics[width=0.8\textwidth]{index_page_pc}
	\caption{Внешний вид страницы для стационарных устройств.}
	\label{fig:index_page_pc}
\end{figure}

\begin{figure}[H]
	\centering
	\includegraphics[width=0.6\textwidth]{index_page_mobile}
	\caption{Внешний вид страницы для мобильных устройств.}
	\label{fig:index_page_mobile}
\end{figure}

\section{Написание документации}

После описания структуры документации и создания заглавной страницы необходимо наполнить документацию. Для описания параметров функций, подробной информации, примеров использования и замечаний в Python создаются так называемые docstrings \cite{docstring-doc} – строковые переменные, которые указываются сразу после объявления объектов в языке – таким образом и происходит описание функций в языке Python. Структура возможной строки будет приведена в листинге ниже.

\begin{lstlisting}[language=RsT, caption=Сокращенное содержание docstring для функции reconstruct.]
	:param x: SSA object
	:type x: SSA
	...
	
	Description
	===========
	
	Reconstruct the data given the SSA decomposition and 
	the desired grouping of the elementary components.
	
	Details
	=======
	
	Reconstruction is performed in a common form for 
	different types of input objects
	...
	
	Note
	----
	
	By default (argument drop.attributes) the routine tries 
	to preserve all the attributes of the input object
	...
	
	References
	----------
	
	Golyandina N., Korobeynikov A., Zhigljavsky A. (2018): 
	Singular Spectrum Analysis with R. Use R!. Springer,
	Berlin, Heidelberg
	...
	
	Examples
	--------
	
	.. code-block:: python
	...
\end{lstlisting}

Когда строка информации создана, пользователь может получить информацию о работе функций либо с помощью встроенной в Python функции help(), либо, при использовании продвинутых сред программирования, наведя курсор на функцию, получить информацию в отформатированном виде.

При повторной генерации HTML-файлов веб-страниц, строки документации также учитываются и сопоставляются с функциями модуля внутри файлов помощи, подхватывая форматирование на языке reStructuredText. Результат для функции reconstruct приведен на иллюстрациях ниже.

\begin{figure}[H]
	\centering
	\includegraphics[width=0.8\textwidth]{rec_par}
	\caption{Внешний вид документации для параметров и описания функции reconstruct.}
	\label{fig:rec_par}
\end{figure}

\begin{figure}[H]
	\centering
	\includegraphics[width=0.6\textwidth]{rec_examples}
	\caption{Внешний вид для замечаний и примеров функции reconstruct.}
	\label{fig:rec_examples}
\end{figure}

\section{Публикация сайта}

Для публикации сайта был выбран хостинг Github Pages \cite{pages-site}, который позволяет опубликовать документацию для общего доступа на основе репозитория, в котором хранится сам пакет pyrssa. Для решения данной задачи необходимо лишь провести предварительную настройку источника загрузки для файлов, относящихся к сайту, и немного изменить структуру их хранения, чтобы Github мог их распознать. Ключевым фактором является наличие в корневой папке файла index.html, который и будет выдавать хостинг при переходе по ссылке. По умолчанию при создании HTML-файлов они находятся во внутренних папках, поэтому сперва проводится корректировка файлов генерации с указанием нужных директорий, а также в корневой папке документации создается небольшой файл index.html, который переадресует на действительную заглавную страницу сайта.

\begin{lstlisting}[language=HTML, caption=Содержимое переадресующего файла index.html.]
	
	<!DOCTYPE html>
	<html lang="en">
	<meta http-equiv="refresh" content="0;
	 url=./html/index.html" />
	</html>
	
\end{lstlisting}

После проведения указанных действий Github при каждом обновлении репозитория, а если быть точнее, ветки, из которой должна подгружаться документация, автоматически их обновляет и спустя пару минут обновленное наполнение сайта становится доступным пользователям.

\chapter{Заключение}

В рамках данной работы были успешно адаптированы файлы помощи пакета Rssa для основных реализованных в pyrssa функций и структур данных, состоящие из их описания, подробной информации и примеров использования в языке Python.

Для достижения этой цели были адаптированы тексты документации Rssa с учетом особенностей реализации на языке Python, к которым относятся типы данных и структуры объектов. Также для большей наглядности были адаптированы и приведены в документации примеры использования функций пакета pyrssa. 

С учетом задачи повышения удобства взаимодействия обучающихся с документацией, помимо адаптации существующих текстов и примеров выполнена работа по написанию документации в формате веб-сайта, содержащего как саму документацию, так и навигацию по страницам. 

Данный веб-сайт опубликован в общем доступе \cite{pyrrsa-doc}, в связи с чем обучающиеся и пользователи могут быстро получить необходимую справку не только внутри используемой среды программирования, но также и при поиске информации в интернете.

\printbibliography
\addcontentsline{toc}{chapter}{Список литературы}

\end{document}